<div class="dashboard">
  <div class="dashboard__header">
    <div class="dashboard__title-group">
      <h1 class="dashboard__title">Panel de consumo</h1>
      <p class="dashboard__subtitle">Sigue de cerca tu uso y controla tus servicios en segundos.</p>
    </div>

    <form class="dashboard__form" [formGroup]="customerForm" (ngSubmit)="loadDashboard()">
      <span class="p-input-icon-left dashboard__input">
        <i class="pi pi-user"></i>
        <input
          pInputText
          type="text"
          formControlName="customerId"
          placeholder="ID de cliente"
          autocomplete="off"
        />
      </span>
      <button
        pButton
        type="submit"
        label="Consultar"
        icon="pi pi-search"
        class="dashboard__search-button"
        [disabled]="loading"
      ></button>
    </form>
  </div>

  <p-card *ngIf="data as dashboard" class="dashboard__card" [style.width]="'100%'">
    <ng-template pTemplate="header">
      <div class="dashboard__card-header">
        <div class="dashboard__card-title-group">
          <span class="dashboard__card-title">Cliente {{ dashboard.profile.cliente_id }}</span>
          <span class="dashboard__card-subtitle">{{ dashboard.profile.nombre }}</span>
        </div>
        <span class="dashboard__chip">
          <i class="pi pi-bolt"></i>
          Informaci贸n actualizada
        </span>
      </div>
    </ng-template>

    <div class="dashboard__summary">
      <div class="dashboard__summary-item dashboard__summary-item--balance">
        <div class="summary-icon">
          <i class="pi pi-wallet"></i>
        </div>
        <div class="summary-content">
          <span class="summary-label">Saldo</span>
          <span class="summary-value">
            {{ dashboard.profile.saldo | currency: 'USD':'symbol-narrow':'1.2-2':'es-EC' }}
          </span>
          <span class="summary-helper">Disponible en tu cuenta</span>
        </div>
      </div>

      <div class="dashboard__summary-item dashboard__summary-item--data">
        <div class="summary-icon">
          <i class="pi pi-chart-line"></i>
        </div>
        <div class="summary-content">
          <span class="summary-label">Datos</span>
          <span class="summary-value">{{ dashboard.profile.consumo_mb | number: '1.0-0':'es-EC' }} MB</span>
          <span class="summary-helper">Consumo de megabytes</span>
        </div>
      </div>

      <div class="dashboard__summary-item dashboard__summary-item--minutes">
        <div class="summary-icon">
          <i class="pi pi-phone"></i>
        </div>
        <div class="summary-content">
          <span class="summary-label">Minutos</span>
          <span class="summary-value">{{ dashboard.profile.minutos | number: '1.0-0':'es-EC' }}</span>
          <span class="summary-helper">Tiempo hablado registrado</span>
        </div>
      </div>
    </div>
  </p-card>

  <p-card class="dashboard__table-card" [style.width]="'100%'">
    <ng-template pTemplate="header">
      <div class="dashboard__card-header">
        <span class="dashboard__card-title">Detalle de consumo</span>
        <span class="dashboard__card-subtitle">Descubre c贸mo se distribuye tu gasto.</span>
      </div>
    </ng-template>

    <p-table
      [value]="consumptionRows"
      [loading]="loading"
      [tableStyle]="{ 'min-width': '18rem' }"
      class="dashboard__table"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>Indicador</th>
          <th>Valor</th>
          <th>Descripci贸n</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-row>
        <tr>
          <td>{{ row.metric }}</td>
          <td>{{ row.value }}</td>
          <td>{{ row.description }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="3" class="dashboard__empty">Sin informaci贸n disponible</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>

<p-progressSpinner *ngIf="loading" class="dashboard__spinner" strokeWidth="4" fill="transparent"></p-progressSpinner>
